<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<html><head>
<script>


function getMousePos1(event) {
var e = event || window.event;
x = e.clientX;
y = e.clientY;
alert('x: ' + x + '\ny: ' + y);


return {'x':e.clientX,'y':e.clientY}
}

function getMousePos(event) {
   var s = document.getElementById("selectmap");
   s.style.display="none";
   var s1 = document.getElementById("showmap");
   s1.style.display="none";  
   var s2 = document.getElementById("backit");
   s2.style.display="none";
   var s3 = document.getElementById("showsubmit");
   s3.style.display = "block";
   
var div1 = document.getElementById("pic1");
//alert(locationLeft(div1));
//alert(locationTop(div1));
var e = event || window.event;
var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
var x = e.pageX || e.clientX + scrollX;
var y = e.pageY || e.clientY + scrollY;
//alert('x: ' + (x-locationLeft(div1)) + '\ny: ' + (y-locationTop(div1)));
 document.getElementById("xpixel").value=(x-locationLeft(div1));
 document.getElementById("ypixel").value=(y-locationTop(div1));
 var s4 = document.getElementById("whichmap");
 s4.value = document.getElementById("maps").options[window.document.getElementById("maps").selectedIndex].text;
 var s5 = document.getElementById("hidden1");
 s5.value = document.getElementById("maps").options[window.document.getElementById("maps").selectedIndex].id;
return { 'x': x, 'y': y };
}


//find the screen location of an element
function locationLeft(element){
    offsetTotal = element.offsetLeft;
    scrollTotal = 0; //element.scrollLeft but we dont want to deal with scrolling - already in page coords
    if (element.tagName != "BODY"){
       if (element.offsetParent != null)
          return offsetTotal+scrollTotal+locationLeft(element.offsetParent);
    }
    return offsetTotal+scrollTotal;
}
//find the screen location of an element
function locationTop(element){
    offsetTotal = element.offsetTop;
    scrollTotal = 0; //element.scrollTop but we dont want to deal with scrolling - already in page coords
    if (element.tagName != "BODY"){
       if (element.offsetParent != null)
          return offsetTotal+scrollTotal+locationTop(element.offsetParent);
    }
    return offsetTotal+scrollTotal;
}
function showmapdiv(){
	var s = document.getElementById("selectmap");
	s.style.display="none";
	var s1 = document.getElementById("showmap");
	s1.style.display="block";
	var s3 = document.getElementById("pic1");
	pic1.src = "../upload/" + window.document.getElementById('maps').value ;
}

function showselectmapdiv(){
   var s = document.getElementById("selectmap");
   s.style.display="block";
   var s1 = document.getElementById("showmap");
   s1.style.display="none";  
   var s2 = document.getElementById("backit");
   s2.style.display="block";

}
function possubmit(){
   var s1 = document.getElementById("showmap");
   s1.style.display="block"; 
   var s2 = document.getElementById("f");
   s2.submit();
}



document.ondblclick = showselectmapdiv;
</script>

<meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<title>地图标点</title></head>
<body>
<div id="selectmap">
<form>
<select name="maps"  onchange="javascript:showmapdiv();">
<option value="请选地图">请选地图</option>
{% for datalist in datalists  %}
<option value="{{datalist.map}}" id="{{datalist.id}}"  >{{datalist.mapname}}</option>

{% endfor %}
</select>
</form>

</div>

<div id=showmap  style="display:none">
<div style="width:1000px; height:2000px; border:#000000 solid 1px; position:absolute" id="main" >
<img src=""  style=" position:absolute; " id="pic1" onclick="javascript:getMousePos();"/>
<div id="imgholder">
	
</div>
</div>
</div>
<div  id="backit"  style="display:none">
<a href="javascrip:showselectmapdiv();"><h1>回去</h1></a>
</div>
<div id=showsubmit  style="display:none">

<form id="f" action="/possubmit" method="post">

<br>
<a>哪张地图：</a><input type="text"  value="maps" id="whichmap"><br>
<input type="hidden"  value=""  id="hidden1" name="hidden1">
<a>位置：</a><input type="text"  value="请简要说明位置！" id="mapcomments" name="mapcomments"><br>
<a>x轴：</a><input type="text"  value="xxx"  id="xpixel" name="xpixel"><br>
<a>y轴：</a><input type="text" value="yyy" id="ypixel" name="ypixel"><br>
<input type="button" onclick="possubmit();" value="Submit">
<br></form>


</div>
</body>
</html>